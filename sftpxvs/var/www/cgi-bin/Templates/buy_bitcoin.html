
<div class="container">

<h1 class="text-center h2 mb-4">Buy <span id="product-name"><TMPL_VAR product_name></span> with <span id="currency-name"><TMPL_VAR currency_name></span></h1>

<div class="block">
  <form action="<TMPL_VAR site_url>" method="GET" name="crypto-checkout" class="mb-4">
    <input type="hidden" name="payment_complete" value="<TMPL_VAR id>-<TMPL_VAR usr_id>">
    <div class="row flex-lg-nowrap">
      <div class="col-auto">
        <div class="mb-3"><img alt="qrcode" id="qr-code" src="data:image/png;base64,<TMPL_VAR qr_code>"></div>
        <a class="btn btn-primary submit-btn px-3 w-100" href="<TMPL_VAR payment_uri>" id="payment-uri">or click here to pay</a>
      </div>
      <div class="col-auto flex-grow-1 flex-shrink-1 mb-3">
        <div class="mb-3">
          <h4 style="font-weight: normal;">Send exactly <strong id="payment-amount">
              <TMPL_VAR amount>
                <TMPL_VAR currency_code>
            </strong> to the following address:</h4>
          <br>
          <input type="text" value="<TMPL_VAR addr>" class="form-control" onfocus="this.select()" style="font-size:14px;">
          <br><br>
          <small class="text-muted">You will be automatically redirected after proceeding with payment.<br> Please note that processing a <TMPL_VAR currency_name> transaction may take up to several minutes.</small>
        </div>
        <div>Time remains: <span id="countdown">1:00:00</span>
          <br><br>
          <div id="progress">
            <div class="progressbar">
              <div class="progress-bar">
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </form>
  <hr class="mb-4 mt-0">
  <h3 class="mt-0 mb-3">FAQ</h3>
  <div class="mb-3">
    <h5><a href="" onclick="$('#faq_1').toggle(); return(false)">1. I don't have <TMPL_VAR currency_name> wallet, where can I signup?</a></h5>
    <div id="faq_1"> Most popular and easy: <a href="https://blockchain.info/wallet/#/signup">blockchain.info</a>, <a href="https://localbitcoins.com/">localbitcoins.com</a>. </div>
  </div>
  <div class="mb-2">
    <h5><a href="" onclick="$('#faq_2').toggle(); return(false)">2. I'm getting some problems during the payment - what should I do?</a></h5>
    <div id="faq_2"> Please don't hesistate to <a href="<TMPL_VAR site_url>/contact/">contact us</a> - we'll pay a highest attention to your report. </div>
  </div>
</div>

<script>
    var interval = setInterval(function() {
      updateCounter();
      checkCompleted();
    }, 1000);
    var pos = 1,
      seconds_to_wait = 3600;

    function updateCounter() {
      var remains = seconds_to_wait - pos;
      if (remains <= 0) return;
      pos += 1;
      var hh = Math.floor(remains / 3600);
      var mm = Math.floor((remains - hh * 3600) / 60);
      var ss = (remains - hh * 3600) % 60;
      var pad = function(n, len) {
        var str = n.toString();
        if (str.length < len) str = '0' + str;
        return str;
      };
      $('#countdown').html([pad(hh, 1), pad(mm, 2), pad(ss, 2)].join(':'));
      var w1 = $('.progressbar').width();
      $('.progress-bar').width(w1 * pos / seconds_to_wait);
    }

    function checkCompleted() {
      $.ajax({
        url: '<TMPL_VAR site_url>',
        method: "POST",
        data: {
          op: 'payments',
          check_transaction: '<TMPL_VAR id>',
          token: '<TMPL_VAR token>',
        },
        success: function(data) {
          if (data.error) {
            alert(data.error);
          } else if (data.status == 'verified') {
            clearInterval(interval);
            document.location = '?payment_complete=<TMPL_VAR id>-1';
          }
        }
      });
    }
  </script>
  <div id="superseeded" style="display: none" title="Transaction superseeded"> This transaction was closed because you have initiated another one. </div>
  <style>
    .progressbar-inner {
      width: 0;
    }
  </style>


</div>
