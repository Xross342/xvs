<script>
  loadT('Transfer queue');
</script>


<div class="row">
	<TMPL_IF srv_list_to>
	<div class="col-lg-6">
		<table class="table table-rounded table-hover align-middle table-justify small">
		<thead>
			<tr><th colspan="2">Stats: Transfers To</th></tr>
		</thead>
		<tbody>
			<TMPL_LOOP srv_list_to>
			<tr><td><a href="?op=admin_transfer_list&srv_id2=<TMPL_VAR srv_id><TMPL_VAR token_str>"><TMPL_VAR srv_name></a></td><td>
			<TMPL_IF PENDING><TMPL_VAR PENDING> pending</TMPL_IF>
			<TMPL_IF MOVING><TMPL_VAR MOVING> moving</TMPL_IF>
			<TMPL_IF STUCK><TMPL_VAR STUCK> stucked</TMPL_IF>
			<TMPL_IF ERROR><TMPL_VAR ERROR> errors</TMPL_IF>
			</td></tr>
			</TMPL_LOOP>
		</tbody>
		</table>

	</div>
	</TMPL_IF>
	<TMPL_IF srv_list_from>
	<div class="col-lg-6">


		<table class="table table-rounded table-hover align-middle table-justify small">
		<thead>
			<tr><th colspan="2">Stats: Transfers From</th></tr>
		</thead>
		<tbody>
			<TMPL_LOOP srv_list_from>
			<tr><td><a href="?op=admin_transfer_list&srv_id1=<TMPL_VAR srv_id><TMPL_VAR token_str>"><TMPL_VAR srv_name></a></td><td>
			<TMPL_IF PENDING><TMPL_VAR PENDING> pending</TMPL_IF>
			<TMPL_IF MOVING><TMPL_VAR MOVING> moving</TMPL_IF>
			<TMPL_IF STUCK><TMPL_VAR STUCK> stucked</TMPL_IF>
			<TMPL_IF ERROR><TMPL_VAR ERROR> errors</TMPL_IF>
			</td></tr>
			</TMPL_LOOP>
		</tbody>
		</table>


	</div>
	</TMPL_IF>
</div>


<TMPL_IF stucked>
<div class="block text-center">
	<input type="button" value="Restart stucked <TMPL_VAR stucked>" onclick="window.location='?op=admin_transfer_list&amp;restart_stucked=1<TMPL_VAR token_str>'" class="btn btn-success m-1">
	<input type="button" value="Cancel stucked <TMPL_VAR stucked>" onclick="window.location='?op=admin_transfer_list&amp;delete_stucked=1<TMPL_VAR token_str>'" class="btn btn-danger m-1">
</div>
</TMPL_IF>

<TMPL_IF errors>
<div class="block text-center">
	<input type="button" value="Restart errors <TMPL_VAR errors>" onclick="window.location='?op=admin_transfer_list&amp;restart_errors=1<TMPL_VAR token_str>'" class="btn btn-success m-1">
	<input type="button" value="Cancel errors <TMPL_VAR errors>" onclick="window.location='?op=admin_transfer_list&amp;delete_errors=1<TMPL_VAR token_str>'" class="btn btn-danger m-1">
</div>
</TMPL_IF>



<form method="POST">
<input type="hidden" name="op" value="admin_transfer_list">
<input type="hidden" name="token" value="<TMPL_VAR token>">



	<div class="table-responsive mb-4">
		<table class="table table-rounded table-hover align-middle table-justify small" id="xfiles">


<thead>
	<tr>
		<th style="width: 1%;"><div class="check-radio"><input type="checkbox" id="selall"></div></th>
		<th class="text-start">Title</th>
		<th style="width: 100px;">Size</th>
		<th style="width: 100px;">Added</th>
		<th style="width: 150px;" title="Source Server">Server From</th>
		<th style="width: 150px;" title="Target Server">Server To</th>
		<th style="width: 150px;">Progress</th>
		</tr>
</thead>
<tbody>
	<TMPL_LOOP list>
	<tr <TMPL_UNLESS __ODD__> class="hi"</TMPL_UNLESS>>
	<td><div class="check-radio"><input type="checkbox" name="file_real" value="<TMPL_VAR file_real>"></div></td>
	<td class="text-start"><a href="<TMPL_VAR download_link>"><TMPL_IF premium><b></TMPL_IF><TMPL_VAR file_title_txt></a><TMPL_VAR qstatus></td>
	<td><TMPL_VAR file_size_total></td>
	<td nowrap><small><TMPL_VAR created2></small></td>
	<td><TMPL_VAR srv_name1> [<TMPL_VAR srv_id1>]</td>
	<td><TMPL_VAR srv_name2> [<TMPL_VAR srv_id2>]</td>
	<td align=left class="enc_td"><div style="position:relative;"><div class="enc_status" style="width:<TMPL_VAR progress>%;"></div><div class="enc_value"><TMPL_VAR progress>%<TMPL_IF transferred> (<TMPL_VAR transferred_mb> of <TMPL_VAR file_size_total>, <TMPL_VAR speed> KB/s)</TMPL_IF></div></div></td>
</tr>
</TMPL_LOOP>
</tbody>
<tfoot>
	<tr>
	<td colspan=9>
	    <input type="submit" name="restart" value="Restart" class="btn btn-success me-2">
	    <input type="submit" name="cancel" value="Cancel" class="btn btn-secondary me-2" onClick="return confirm('Cancel selected transfers?')">
	    <input type="submit" name="delete" value="Delete File" class="btn btn-danger" onClick="return confirm('Delete selected files?')">
	</td>
	</tr>
</tfoot>
</table>
</div>

</form>

<TMPL_VAR paging>

<script>
$(document).ready(function(){
    $("input[name=file_real]").change( function(){ $(this).parent().parent().toggleClass('hi2'); } );
    $("#selall").change(function(){
           var sel=this.checked;
           $("#xfiles input[name=file_real]:enabled").each(function(){
               $(this).prop('checked',sel);
               if(sel){$(this).parent().parent().addClass('hi2');} else {$(this).parent().parent().removeClass('hi2');}
           });
    });
});
</script>
