<script>
  loadT('MySQL table statistics');
</script>

<form method="post">
  <input type="hidden" name="op" value="admin_sql_stats">
  <input type="hidden" name="token" value="<TMPL_VAR token>">
  <div class="table-responsive">
    <table class="table table-hover table-rounded align-middle small">
      <thead>
        <tr>
          <th style="width: 1%;">
            <div class="check-radio"><input type="checkbox" id="selectall" title="Select all"></div>
          </th>
          <th>Table name</th>
          <th>Rows</th>
          <th>Data Size</th>
          <th>Index Size</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <TMPL_LOOP list>
          <tr>
            <td>
              <div class="check-radio"><input type="checkbox" name="table" value="<TMPL_VAR Name>"></div>
            </td>
            <td>
              <TMPL_VAR Name>
            </td>
            <td>
              <TMPL_VAR Rows>
            </td>
            <td>
              <TMPL_VAR Data_length>
            </td>
            <td>
              <TMPL_VAR Index_length>
            </td>
            <!--td><a href="?op=admin_sql_stats&table=<TMPL_VAR Name>&exec=opt">OPTIMIZE</a></td-->
            <td>
              <TMPL_IF truncate><a href="?op=admin_sql_stats&table=<TMPL_VAR Name>&exec=trunc<TMPL_VAR token_str>" onclick="return confirm('Really cleanup this table?')">TRUNCATE</a></TMPL_IF>
            </td>
          </tr>
        </TMPL_LOOP>
      </tbody>
      <tfoot>
        <tr>
          <th colspan="7">
            <input type="submit" name="optimize" value="Optimize" class="btn btn-primary">
            <input type="submit" name="repair" value="Repair" class="btn btn-success">
            <input type="submit" name="dump" value="Dump to gz" class="btn btn-outline-light">
          </th>
        </tr>
      </tfoot>
    </Table>
  </div>
</form>
<script>
$("#selectall").change(function() {
        	var sel=this.checked;
        	$("input[name=table]:enabled").each(function(){
        	    $(this).prop('checked',sel);
                $(this).change();
        	});
    });
</script>
