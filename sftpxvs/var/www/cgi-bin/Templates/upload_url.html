<div class="col-xxl-9 mx-auto">
	<div class="block p-0">
		<TMPL_INCLUDE upload_menu.html>
			<div class="p-3 p-lg-5">
				<TMPL_IF msg>
					<div class="alert alert-success">
						<TMPL_VAR msg>
					</div>
				</TMPL_IF>
				<Form method="POST" action="<TMPL_VAR site_url>/" onSubmit="return validateURLForm(this)">
					<input type="hidden" name="op" value="upload_url">
					<div class="mb-3">
						<label class="form-label">
							<TMPL_VAR lng_uploadform_max_filesize>: <TMPL_VAR max_upload_filesize> Mb<br>
									<TMPL_VAR lng_uploadurl_you_can_enter_up_to>
										<TMPL_VAR slots_left> URLs:<br>
						</label>
						<textarea class="form-control" rows="8" name="urls" wrap="off"></textarea>
					</div>
					<TMPL_IF tos_accept_checkbox>
						<div class="mb-3">
							<div class="check-radio justify-content-end">
								<label for="tos4" class="me-2 text-end">
									<TMPL_VAR lng_uploadform_i_agree> <a href="tos.html">
											<TMPL_VAR lng_uploadform_tos_short>
										</a>
								</label>
								<input type="checkbox" name="tos" value="1" id="tos4" checked onClick="if(this.checked){this.form.submit_btn.disabled=false}else{this.form.submit_btn.disabled=true};this.blur();">
							</div>
						</div>
					</TMPL_IF>
					<div class="text-end pt-2">
						<button type="button" data-bs-toggle="modal" data-bs-target="#options" class="btn btn-outline-light big-btn me-2">Options</button>
						<button type="submit" name="submit_btn" class="btn btn-primary submit-btn">
							<TMPL_VAR lng_uploadurl_add_to_upload_queue>
						</button>
					</div>
					<div class="modal fade" id="options" tabindex="-1">
						<div class="modal-dialog modal-dialog-centered">
							<div class="modal-content">
								<div class="modal-header">
									<h5 class="modal-title"> Options </h5>
									<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
								</div>
								<div class="modal-body">
									<TMPL_IF hosts>
										<div class="mb-3">
											<label class="form-label">Upload server:</label>
											<select class="form-select" name="srv_id">
												<TMPL_LOOP hosts>
													<optgroup label="<TMPL_VAR host_name>">
														<TMPL_LOOP servers>
															<option value="<TMPL_VAR srv_id>" <TMPL_VAR selected>><TMPL_VAR srv_name>
															</option>
														</TMPL_LOOP>
													</optgroup>
												</TMPL_LOOP>
											</select>
										</div>
									</TMPL_IF>
									<div class="mb-3">
										<label class="form-label">
											<TMPL_VAR lng_myfiles_folder>
										</label>
										<select class="form-select" name="fld_id" id="fld_id" onChange="$.cookie('up_fld_id',this.value,{ expires: 300 })">
											<option value="0"> / </option>
											<option value="000">-Create new-</option>
											<TMPL_LOOP folders_tree>
												<option value="<TMPL_VAR fld_id>" <TMPL_VAR selected>><TMPL_VAR pre>
														<TMPL_VAR fld_name>
												</option>
											</TMPL_LOOP>
										</select>
									</div>
									<div class="mb-3">
										<label class="form-label">
											<TMPL_VAR lng_uploadform_category>
										</label>
										<select class="form-select" name="cat_id" id="cat_id">
											<option value="0">
												<TMPL_VAR lng_uploadform_choose>
											</option>
											<TMPL_LOOP categories>
												<option value="<TMPL_VAR cat_id>">
													<TMPL_VAR pre>
														<TMPL_VAR cat_name>
											</TMPL_LOOP>
										</select>
									</div>
									<div class="mb-3">
										<label class="form-label">
											<TMPL_VAR lng_uploadform_tags>
										</label>
										<input type="text" name="tags" class="form-control">
									</div>
									<div class="mb-3">
										<label class="form-switcher"><input type="checkbox" name="file_public" value="1">
											<TMPL_VAR lng_uploadform_public>
										</label>
									</div>
									<div class="mb-3">
										<label class="form-switcher"><input type="checkbox" name="file_adult" value="1">
											<TMPL_VAR lng_uploadform_adult>
										</label>
									</div>
									<TMPL_LOOP extra_data>
										<div class="mb-3">
											<label class="form-label">
												<TMPL_VAR name>
											</label>
											<input type="text" name="extra_<TMPL_VAR name>" value="" class="form-control">
										</div>
									</TMPL_LOOP>
								</div>
								<div class="modal-footer">
									<button type="button" data-bs-dismiss="modal" class="btn btn-outline-light">Close</button>
								</div>
							</div>
						</div>
					</div>
				</Form>
			</div>
	</div>
	<TMPL_IF list>
		<div class="h5 text-center text-dark">
			<TMPL_VAR lng_uploadurl_your_pending_urls>
		</div>
		<div class="nav justify-content-center mb-3">
			<a class="nav-link" href="/?op=upload_url&restart_errors=1">Restart All Errors</a> &nbsp; <a class="nav-link link-danger" href="/?op=upload_url&delete_errors=1">Delete All Errors</a> &nbsp; <a class="nav-link link-danger"
				href="/?op=upload_url&delete_pending=1" onclick="return confirm('You want to delete all PENDING URL uploads?');">Delete All Pending</a>
		</div>
		<div class="table-responsive mb-4">
			<table class="table table-rounded align-middle">
				<thead>
					<tr>
						<th>URL</th>
						<th>
							<TMPL_VAR lng_uploadurl_created>
						</th>
						<th>
							<TMPL_VAR lng_uploadurl_status>
						</th>
						<th style="width: 1%;">Action</th>
					</tr>
				</thead>
				<tbody>
					<TMPL_LOOP list>
						<tr>
							<td>
								<TMPL_VAR url>
							</td>
							<td>
								<TMPL_VAR created>
							</td>
							<td class="enc_td">
								<div style="position:relative;">
									<div class="enc_status" style="width:<TMPL_VAR progress>%;"></div>
									<div class="enc_value">
										<TMPL_IF size_full>
											<TMPL_VAR progress>% (<TMPL_VAR size_dl> MB of <TMPL_VAR size_full> MB) <TMPL_VAR speed> KB/s<TMPL_ELSE>
																<TMPL_VAR status>
										</TMPL_IF>
									</div>
								</div>
							</td>
							<td class="text-center"><a href="/?op=upload_url&amp;del_id=<TMPL_VAR id>"><img src="<TMPL_VAR site_url>/images2/delete.svg" alt=""></a></td>
						</tr>
					</TMPL_LOOP>
				</tbody>
			</table>
		</div>
	</TMPL_IF>
</div>


<script src="<TMPL_VAR static_url>/js/jquery.cookie.js"></script>
<script>
var lng_uploadurl_select_url_to_upload='<TMPL_VAR lng_uploadurl_select_url_to_upload>';
var lng_uploadform_agree_to_tos='<TMPL_VAR lng_uploadform_agree_to_tos>';
var category_required='<TMPL_VAR category_required>';
$("select[name=cat_id]").val( $.cookie('cat_id') );
$("select[name=cat_id]").change(function(){ $.cookie('cat_id', $("#cat_id").val(), { expires: 9999 }); });
$("input[name=file_public]").prop("checked", $.cookie('file_public') );
$("input[name=file_public]").click(function(){ var val='';if($(this).prop("checked"))val=1;$.cookie('file_public', val, { expires: 9999 }); });
$("input[name=file_adult]").prop("checked", $.cookie('file_adult') );
$("input[name=file_adult]").click(function(){ var val='';if($(this).prop("checked"))val=1;$.cookie('file_adult', val, { expires: 9999 }); });
function validateURLForm(f)
{
    <TMPL_IF category_required>
    if($('#cat_id').val()==0) { alert("<TMPL_VAR lng_uploadurl_choose_category>"); return false; }
    </TMPL_IF>

    var NF = 0;
    var arr = f.urls.value.split(/\n/);
    for(i = 0; i < arr.length; i++)
    {
        if(arr[i].length > 10)NF++;
    }
    if(NF<=0){alert(lng_uploadurl_select_url_to_upload);return false;};
    if(f.tos && !f.tos.checked){alert(lng_uploadform_agree_to_tos);return false;};
}
$("#fld_id").change(function()
{
 if($(this).val()!="000")return false;
 x=prompt('New folder name','');
 if(typeof(x)=='undefined' || x=='' || x==null){$("#fld_id").val('0');return false;}
 $.post("<TMPL_VAR site_url>/", {op:"ajax_new_folder", create_new_folder:x}, function(data) {
  if(!data.match(/^<option/i)){alert(data)}
  else {$("#fld_id").append(data);$("#fld_id option:last").attr('selected','selected');}
 });
});
</script>
